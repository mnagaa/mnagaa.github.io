[{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) SNS / Link Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog 📗Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\nCurrent: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - Current: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nSoftware https://github.com/mnagaa/stackerrors 🗣️Talks 色々話したことを自分が思い出すために\u0026hellip;\n2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説 キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min Go言語について、上級レベルの勉強会 2023.5 社内新卒研修 「データベース・SQL研修」 90min RDBやSQLについての研修 2023.5 社内新卒研修 「データエンジニアリング研修」 90min データ基盤の作り方などを新卒向けに解説 Blog Amazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] Engineering Skills Performance Tuning\nGo AWS: 4 certified MySQL Cache (in-memory, cache system) SQL Go (Most used programming language)\nmany!! Python\nFastAPI, Flask, gensim, Pytorch, Scrapy, Spider etc. Poetry etc. JavaScript/TypeScript: React, Vue, MUI, Vuetify, Chakra UI, Next, Nuxt\nOperating Systems\nMac Linux Databases / Data Warehouse\nMySQL PostgreSQL Snowflake DynamoDB Redis Memcached Cloud Infrastructure\nAWS: 4 certified ⭐️⭐️⭐️⭐️ Snowflake Datadog Google Cloud Others\nDocker Terraform (AWS, Snowflake) GitHub, GitHub Actions RabbitMQ zsh, bash Certifications CG Engineer Expert (2018) TOEIC 835 (2018) AWS: 4 certified OSS Contribution terraform-provider-snowflake 📗Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform Posts Blog posts can be found here. ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"},{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) SNS / Link Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog 📗Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\nCurrent: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - Current: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nSoftware https://github.com/mnagaa/stackerrors 🗣️Talks 色々話したことを自分が思い出すために\u0026hellip;\n2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説 キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min Go言語について、上級レベルの勉強会 2023.5 社内新卒研修 「データベース・SQL研修」 90min RDBやSQLについての研修 2023.5 社内新卒研修 「データエンジニアリング研修」 90min データ基盤の作り方などを新卒向けに解説 Blog Amazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] Engineering Skills Performance Tuning\nGo AWS: 4 certified MySQL Cache (in-memory, cache system) SQL Go (Most used programming language)\nmany!! Python\nFastAPI, Flask, gensim, Pytorch, Scrapy, Spider etc. Poetry etc. TypeScript / JavaScript\nTypeScript: React, Next, Chakra UI, MUI, etc. JavaScript: Vue, Nuxt, Vuetify, etc. Operating Systems\nMac Linux Databases / Data Warehouse\nMySQL PostgreSQL Snowflake DynamoDB Redis Cloud Spanner Memcached Cloud Infrastructure\nAWS: 4 certified ⭐️⭐️⭐️⭐️ Snowflake Datadog Google Cloud (Cloud Spanner, BigQuery, Cloud Run, Cloud Functions, etc.) Others\nDocker Terraform (AWS, Snowflake) GitHub, GitHub Actions RabbitMQ zsh, bash Certifications CG Engineer Expert (2018) TOEIC 835 (2018) AWS: 4 certified OSS Contribution terraform-provider-snowflake 📗Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform Posts Blog posts can be found here. ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"},{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) SNS / Link Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog 📗Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\nCurrent: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - Current: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nSoftware https://github.com/mnagaa/stackerrors 🗣️Talks 色々話したことを自分が思い出すために\u0026hellip;\n2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説 キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min Go言語について、上級レベルの勉強会 2023.5 社内新卒研修 「データベース・SQL研修」 90min RDBやSQLについての研修 2023.5 社内新卒研修 「データエンジニアリング研修」 90min データ基盤の作り方などを新卒向けに解説 Blog Amazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] Engineering Skills Performance Tuning\nGo AWS: 4 certified MySQL Cache (in-memory, cache system) SQL Go (Most used programming language)\nmany!! Python\nFastAPI, Flask, gensim, Pytorch, Scrapy, Spider etc. Poetry etc. TypeScript / JavaScript\nTypeScript: React, Next, Chakra UI, MUI, etc. JavaScript: Vue, Nuxt, Vuetify, etc. Architecture / Design\nDomain-Driven Design (DDD) Distributed Systems / Distributed Architecture Operating Systems\nMac Linux Databases / Data Warehouse\nMySQL PostgreSQL Snowflake DynamoDB Redis Cloud Spanner Memcached Cloud Infrastructure\nAWS: 4 certified ⭐️⭐️⭐️⭐️ Snowflake Datadog Google Cloud (Cloud Spanner, BigQuery, Cloud Run, Cloud Functions, etc.) Others\nDocker Terraform (AWS, Snowflake) GitHub, GitHub Actions RabbitMQ zsh, bash Certifications CG Engineer Expert (2018) TOEIC 835 (2018) AWS: 4 certified OSS Contribution terraform-provider-snowflake 📗Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform Posts Blog posts can be found here. ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"},{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\nCurrent: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - Current: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nEngineering Skills Languages \u0026amp; Frameworks Go — メインで使用。並行処理、サーバー、CLI など Python — FastAPI, Flask, PyTorch, gensim, Scrapy, Poetry など TypeScript / JavaScript — React, Next, Vue, Nuxt, Chakra UI, MUI, Vuetify など Architecture \u0026amp; Design Domain-Driven Design (DDD) Distributed Systems / Distributed Architecture Data \u0026amp; Storage RDB / Data Warehouse: MySQL, PostgreSQL, Snowflake, Cloud Spanner NoSQL / Cache: DynamoDB, Redis, Memcached Cloud \u0026amp; Infrastructure AWS — 4 certified ⭐️ Google Cloud — Cloud Spanner, BigQuery, Cloud Run, Cloud Functions など Snowflake, Datadog Terraform (AWS, Snowflake), Docker, GitHub Actions Performance \u0026amp; Tuning サーバー・DB・SQL のチューニング、インメモリキャッシュ設計 Tools \u0026amp; Others GitHub, RabbitMQ, zsh, bash — Mac / Linux Certifications AWS: 4 certified CG Engineer Expert (2018) TOEIC 835 (2018) Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) 📗 Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) 📗 Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform 🗣️ Talks 2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説、キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min — Go言語上級向け 2023.5 社内新卒研修 「データベース・SQL研修」 90min 2023.5 社内新卒研修 「データエンジニアリング研修」 90min — データ基盤の作り方などを新卒向けに解説 Blog / Posts はてなブログ: 最近の記事（下に一覧） Zenn: 投稿一覧 はてなブログ 最近記事:\nAmazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] OSS / Software terraform-provider-snowflake — コントリビューション stackerrors SNS / Links Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"},{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\n- 2025.05: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - Current: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nEngineering Skills Languages \u0026amp; Frameworks Go — メインで使用。並行処理、サーバー、CLI など Python — FastAPI, Flask, PyTorch, gensim, Scrapy, Poetry など TypeScript / JavaScript — React, Next, Vue, Nuxt, Chakra UI, MUI, Vuetify など Architecture \u0026amp; Design Domain-Driven Design (DDD) Distributed Systems / Distributed Architecture Data \u0026amp; Storage RDB / Data Warehouse: MySQL, PostgreSQL, Snowflake, Cloud Spanner NoSQL / Cache: DynamoDB, Redis, Memcached Cloud \u0026amp; Infrastructure AWS — 4 certified ⭐️ Google Cloud — Cloud Spanner, BigQuery, Cloud Run, Cloud Functions など Snowflake, Datadog Terraform (AWS, Snowflake), Docker, GitHub Actions Performance \u0026amp; Tuning サーバー・DB・SQL のチューニング、インメモリキャッシュ設計 Tools \u0026amp; Others GitHub, RabbitMQ, zsh, bash — Mac / Linux Certifications AWS: 4 certified CG Engineer Expert (2018) TOEIC 835 (2018) Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) 📗 Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) 📗 Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform 🗣️ Talks 2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説、キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min — Go言語上級向け 2023.5 社内新卒研修 「データベース・SQL研修」 90min 2023.5 社内新卒研修 「データエンジニアリング研修」 90min — データ基盤の作り方などを新卒向けに解説 Blog / Posts はてなブログ: 最近の記事（下に一覧） Zenn: 投稿一覧 はてなブログ 最近記事:\nAmazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] OSS / Software terraform-provider-snowflake — コントリビューション stackerrors SNS / Links Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"},{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\n2024.02 - 2025.07: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - 2024.01: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nEngineering Skills Languages \u0026amp; Frameworks Go — メインで使用。並行処理、サーバー、CLI など Python — FastAPI, Flask, PyTorch, gensim, Scrapy, Poetry など TypeScript / JavaScript — React, Next, Vue, Nuxt, Chakra UI, MUI, Vuetify など Architecture \u0026amp; Design Domain-Driven Design (DDD) Distributed Systems / Distributed Architecture Data \u0026amp; Storage RDB / Data Warehouse: MySQL, PostgreSQL, Snowflake, Cloud Spanner NoSQL / Cache: DynamoDB, Redis, Memcached Cloud \u0026amp; Infrastructure AWS — 4 certified ⭐️ Google Cloud — Cloud Spanner, BigQuery, Cloud Run, Cloud Functions など Snowflake, Datadog Terraform (AWS, Snowflake), Docker, GitHub Actions Performance \u0026amp; Tuning サーバー・DB・SQL のチューニング、インメモリキャッシュ設計 Tools \u0026amp; Others GitHub, RabbitMQ, zsh, bash — Mac / Linux Certifications AWS: 4 certified CG Engineer Expert (2018) TOEIC 835 (2018) Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) 📗 Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) 📗 Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform 🗣️ Talks 2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説、キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min — Go言語上級向け 2023.5 社内新卒研修 「データベース・SQL研修」 90min 2023.5 社内新卒研修 「データエンジニアリング研修」 90min — データ基盤の作り方などを新卒向けに解説 Blog / Posts はてなブログ: 最近の記事（下に一覧） Zenn: 投稿一覧 はてなブログ 最近記事:\nAmazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] OSS / Software terraform-provider-snowflake — コントリビューション stackerrors SNS / Links Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"},{"content":"Go言語 気になることのメモ。\nGoにおける列挙型(enum)の表現 Go言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\n基本的な列挙型の表現 以下のコードは、色を表現するColor型を定義する例です。\n// 後で触れますが、これは推奨されない方法です。 type Color int const ( Red Color = iota Blue Yellow ) この例では、Colorという新しい型を定義し、int型をベースとしています。これは、iotaが整数を生成するためです。この定義により、Redは0、Blueは1、Yellowは2という値を持つことになります。\n多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のようにStringメソッドを定義します。\nfunc (c Color) String() string { switch c { case Red: return \u0026#34;Red\u0026#34; case Blue: return \u0026#34;Blue\u0026#34; case Yellow: return \u0026#34;Yellow\u0026#34; default: return \u0026#34;Unknown\u0026#34; } } 注意点と改善方法 上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\nGoにおけるint型のゼロ値は0です。このため、Color型のゼロ値も0となります。上記の例では、ゼロ値がRedに対応してしまうため、何も指定しない場合のデフォルトがRedとなってしまいます。\nこの問題を解決するためには、ゼロ値をUnknownとして定義するか、iota+1で数え始める方法があります。\ntype Color int const ( UnknownColor = iota // ゼロ値をUnknownとして定義 Red Blue Yellow ) const ( Red Color = iota + 1 // 1から数え始める Blue Yellow ) 個人的には、uintで定義するのが好きです。 uint型を使用することで、負の値を持たない列挙型を作成できる。 追加情報 Stringerインターフェース: Stringメソッドは、Goの組み込みインターフェースであるStringerインターフェースを実装しています。これにより、fmt.Printlnなどの関数でColor型の変数を直接出力すると、定義した文字列が表示されます。 列挙型の拡張: 列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。 列挙型の比較: 列挙型の値は、基本型（この場合はint）として比較することができます。これにより、switch文やif文での条件分岐が容易になります。 列挙型の安全性: Goでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。 参考文献 Goのenumのようなものの定義方法 Goのiotaの完全理解 Goのstructとメソッド GoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、classの概念がない。その代わり、structを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\n継承の欠如: Goには継承の概念がない。しかし、structの中に別のstructを組み込むことで、継承のような機能を模倣することができる。これにより、多重継承の問題を回避することができる。\nインターフェースの暗黙性: Goのインターフェースは他の言語とは異なり、型がインターフェースのメソッドを持っていれば、明示的に宣言することなくそのインターフェースを実装するとみなされる。これはコードの柔軟性と再利用性を高める。\nポリモーフィズム: Goはインターフェースを利用してポリモーフィズムをサポートしている。これにより、異なる型でも同じインターフェースを実装していれば、同じように扱うことができる。\nカプセル化: Goでは名前の先頭が大文字であればそれは公開され、小文字であれば非公開となる。これにより、パッケージの境界をもとにしたカプセル化が可能となる。\nGoのインターフェースの詳細 基本的なインターフェースの定義: SpeakerというインターフェースはSpeakメソッドを持つことを要求する。\ntype Speaker interface { Speak() string } インターフェースの実装: DogとCatはそれぞれSpeakメソッドを実装している。Goでは、これだけでSpeakerインターフェースを実装しているとみなされる。\ntype Dog struct{} func (d Dog) Speak() string { return \u0026#34;Woof!\u0026#34; } type Cat struct{} func (c Cat) Speak() string { return \u0026#34;Meow!\u0026#34; } インターフェースの利用: Introduce関数はSpeakerインターフェースを引数として受け取り、そのSpeakメソッドを呼び出す。\nfunc Introduce(s Speaker) { fmt.Println(\u0026#34;The animal says:\u0026#34;, s.Speak()) } func main() { d := Dog{} c := Cat{} Introduce(d) // 出力: The animal says: Woof! Introduce(c) // 出力: The animal says: Meow! } カプセル化の詳細 カプセル化は、データとそのデータを操作するメソッドを一つの単位にまとめ、外部からの不正なアクセスや変更を防ぐオブジェクト指向の核心的な概念である。Goでは、公開と非公開の2つの可視性のみをサポートしており、これによりシンプルかつ効果的なカプセル化が実現されている。\nGoにおけるカプセル化の利点 Goのカプセル化のアプローチは以下の利点を持つ。\nシンプルさ: Goのカプセル化は名前の先頭文字の大文字・小文字で実現。private, protected, publicのような修飾子は不要。 明確なパッケージの境界: Goのカプセル化はパッケージレベルで行われる。どの部分が外部に公開されているか、どの部分が非公開かが明確。 データの整合性の維持: 非公開のフィールドやメソッドを通じてのみデータにアクセスできる。データの整合性を維持しやすい。 Goにおけるカプセル化の実践 Goでカプセル化を実践する方法は以下の通り。\nゲッターとセッター: 非公開のフィールドに対して、ゲッター(getter)やセッター(setter)を提供。フィールドの直接的なアクセスを制限しつつ、必要な操作を許可。\ntype Circle struct { radius float64 } func (c *Circle) Radius() float64 { return c.radius } func (c *Circle) SetRadius(r float64) { if r \u0026gt; 0 { c.radius = r } } 非公開のヘルパーメソッド: 複雑な操作や計算を非公開のヘルパーメソッドで定義。公開メソッドからそれを呼び出すことで、内部のロジックを隠蔽。\nインターフェースを利用したカプセル化: 具体的な型の詳細を隠蔽し、インターフェースを公開。実装の詳細を隠すことができる。\nGoは独自の方法でカプセル化をサポートし、データの保護と整合性を維持することができる。\n「カプセル化についてまとめたけど、Goでこれをやるメリットはあまり感じられないので使える時に使おうという感想」\nゼロ幅のメモリ割り当て ゼロ幅のメモリ割り当ての用途は主に、パフォーマンスの最適化やメモリ使用量の削減にある。\ntype key struct{} var p key = struct{}{} 特別なメソッド Go言語では、特定のインターフェイスを実装することにより、型に対して追加の振る舞いを定義することができます。その中でも特によく使われるのが、StringメソッドとGoStringメソッドです。\nStringメソッド Stringメソッドは、fmt.Stringerインターフェイスを実装することによって定義されます。このインターフェイスは、String() stringというシグネチャを持つ単一のメソッドを要求します。このメソッドを実装することにより、その型のインスタンスを文字列として表現する方法をカスタマイズできます。fmtパッケージの関数（例えばfmt.Printlnやfmt.Printfなど）を通じてオブジェクトが出力される際に、このStringメソッドが自動的に呼び出され、その返り値が使用されます。\ntype Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\u0026#34;%s (%d years)\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にStringメソッドを実装しています。このメソッドは、Personインスタンスを\u0026quot;Name (Age years)\u0026quot;の形式の文字列に変換します。\nGoStringメソッド GoStringメソッドは、fmt.GoStringerインターフェイスを実装することで定義されます。このインターフェイスはGoString() stringというメソッドを要求し、このメソッドはオブジェクトのGo言語における文字列表現を提供することを目的としています。fmtパッケージの%#vのようなフォーマット指定子を用いた出力時に、このGoStringメソッドがあれば、それが呼び出されます。\nfunc (p Person) GoString() string { return fmt.Sprintf(\u0026#34;Person{Name: %q, Age: %d}\u0026#34;, p.Name, p.Age) } 上記の例では、Person型にGoStringメソッドを実装しています。このメソッドは、PersonインスタンスをPerson{Name: \u0026quot;Name\u0026quot;, Age: Age}の形式のGoのコードとして表現する文字列に変換します。これはデバッグ時にオブジェクトの状態を明確に理解するのに役立ちます。\nまとめ Stringメソッドは、オブジェクトの文字列表現をカスタマイズするために使用され、fmt.Stringerインターフェイスを通じて定義されます。 GoStringメソッドは、オブジェクトのGo言語における文字列表現を提供し、fmt.GoStringerインターフェイスを通じて定義されます。 これらのメソッドを適切に実装することで、ログ出力やデバッグ情報の表示をより有効にすることができます。 ","permalink":"http://localhost:1313/posts/go/","summary":"\u003ch1 id=\"go言語\"\u003eGo言語\u003c/h1\u003e\n\u003cp\u003e気になることのメモ。\u003c/p\u003e\n\u003ch2 id=\"goにおける列挙型enumの表現\"\u003eGoにおける列挙型(enum)の表現\u003c/h2\u003e\n\u003cp\u003eGo言語には、多くの他のプログラミング言語に存在する列挙型(enum)はありません。しかし、Goでenumのような機能を実現する方法があります。\u003c/p\u003e\n\u003ch3 id=\"基本的な列挙型の表現\"\u003e基本的な列挙型の表現\u003c/h3\u003e\n\u003cp\u003e以下のコードは、色を表現する\u003ccode\u003eColor\u003c/code\u003e型を定義する例です。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 後で触れますが、これは推奨されない方法です。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eこの例では、\u003ccode\u003eColor\u003c/code\u003eという新しい型を定義し、\u003ccode\u003eint\u003c/code\u003e型をベースとしています。これは、\u003ccode\u003eiota\u003c/code\u003eが整数を生成するためです。この定義により、\u003ccode\u003eRed\u003c/code\u003eは0、\u003ccode\u003eBlue\u003c/code\u003eは1、\u003ccode\u003eYellow\u003c/code\u003eは2という値を持つことになります。\u003c/p\u003e\n\u003cp\u003e多くの場合、このような数値から具体的な文字列を取得したいという要求があります。そのため、以下のように\u003ccode\u003eString\u003c/code\u003eメソッドを定義します。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Red\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Blue\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Yellow\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Unknown\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"注意点と改善方法\"\u003e注意点と改善方法\u003c/h3\u003e\n\u003cp\u003e上記の方法は、一見すると問題なく動作するように見えますが、実は問題点があります。\u003c/p\u003e\n\u003cp\u003eGoにおける\u003ccode\u003eint\u003c/code\u003e型のゼロ値は0です。このため、\u003ccode\u003eColor\u003c/code\u003e型のゼロ値も0となります。上記の例では、ゼロ値が\u003ccode\u003eRed\u003c/code\u003eに対応してしまうため、何も指定しない場合のデフォルトが\u003ccode\u003eRed\u003c/code\u003eとなってしまいます。\u003c/p\u003e\n\u003cp\u003eこの問題を解決するためには、ゼロ値を\u003ccode\u003eUnknown\u003c/code\u003eとして定義するか、\u003ccode\u003eiota+1\u003c/code\u003eで数え始める方法があります。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eUnknownColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ゼロ値をUnknownとして定義\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eRed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eColor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003eiota\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 1から数え始める\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eBlue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eYellow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e個人的には、\u003ccode\u003euint\u003c/code\u003eで定義するのが好きです。\nuint型を使用することで、負の値を持たない列挙型を作成できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"追加情報\"\u003e追加情報\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eStringerインターフェース\u003c/strong\u003e:\n\u003ccode\u003eString\u003c/code\u003eメソッドは、Goの組み込みインターフェースである\u003ccode\u003eStringer\u003c/code\u003eインターフェースを実装しています。これにより、\u003ccode\u003efmt.Println\u003c/code\u003eなどの関数で\u003ccode\u003eColor\u003c/code\u003e型の変数を直接出力すると、定義した文字列が表示されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の拡張\u003c/strong\u003e:\n列挙型を拡張する場合、新しい値を追加する際にはリストの最後に追加することで、既存のコードの動作を変更しないようにすることが推奨されます。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の比較\u003c/strong\u003e:\n列挙型の値は、基本型（この場合は\u003ccode\u003eint\u003c/code\u003e）として比較することができます。これにより、\u003ccode\u003eswitch\u003c/code\u003e文や\u003ccode\u003eif\u003c/code\u003e文での条件分岐が容易になります。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e列挙型の安全性\u003c/strong\u003e:\nGoでは、列挙型のようなものを使うことで、特定の値のセットのみを受け入れるように型を制限することができます。これにより、不正な値が設定されるのを防ぐことができます。。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考文献\"\u003e参考文献\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.y-yuki.net/entry/2017/05/09/000000\"\u003eGoのenumのようなものの定義方法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://speakerdeck.com/uji/5fen-dewan-quan-li-jie-surugofalseiota\"\u003eGoのiotaの完全理解\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"goのstructとメソッド\"\u003eGoのstructとメソッド\u003c/h2\u003e\n\u003cp\u003eGoはJavaやC++のような伝統的なオブジェクト指向言語とは異なり、\u003ccode\u003eclass\u003c/code\u003eの概念がない。その代わり、\u003ccode\u003estruct\u003c/code\u003eを使ってデータ構造を定義し、それに関連するメソッドを結びつけることができる。\u003c/p\u003e","title":"Go言語"},{"content":"セキュリティ概論 自学用。\n認証と認可 ①認証(Authentication, AuthN) ログイン時にユーザ名やパスワードを用いて自分を証明すること MFA(多要素認証)などもある。 方法 知識認証 IDとパスワードを用いる 生体認証 顔認証 所持情報 電話番号 デバイス ②認証(Authorization, AuthZ) 認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか ユーザーがシステム内で何ができるのか ","permalink":"http://localhost:1313/posts/security1/","summary":"\u003ch1 id=\"セキュリティ概論\"\u003eセキュリティ概論\u003c/h1\u003e\n\u003cp\u003e自学用。\u003c/p\u003e\n\u003ch2 id=\"認証と認可\"\u003e認証と認可\u003c/h2\u003e\n\u003ch3 id=\"認証authentication-authn\"\u003e①認証(Authentication, AuthN)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eログイン時にユーザ名やパスワードを用いて自分を証明すること\u003c/li\u003e\n\u003cli\u003eMFA(多要素認証)などもある。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法\"\u003e方法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e知識認証\n\u003cul\u003e\n\u003cli\u003eIDとパスワードを用いる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e生体認証\n\u003cul\u003e\n\u003cli\u003e顔認証\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e所持情報\n\u003cul\u003e\n\u003cli\u003e電話番号\u003c/li\u003e\n\u003cli\u003eデバイス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"認証authorization-authz\"\u003e②認証(Authorization, AuthZ)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e認証されたユーザーが特定のリソースやサービスにアクセスする権利があるのか\u003c/li\u003e\n\u003cli\u003eユーザーがシステム内で何ができるのか\u003c/li\u003e\n\u003c/ul\u003e","title":"セキュリティ概論"},{"content":"ソフトウェア概論 自学用メモ。\n関数の副作用 関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。 具体的な例:\nグローバル変数の変更：関数内でグローバル変数の値を変える。 ファイル操作：ファイルの読み込みや保存。 データベース操作：データの追加、更新、削除など。 画面出力：ユーザーインターフェースへの情報の表示。 純粋関数と副作用 純粋関数：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\n副作用の利点・欠点:\n利点：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。 欠点：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。 副作用のある関数のテスト方法 Mock：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\nStub：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\nSpy：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\n状態のリセット：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\n統合テスト：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\n値渡しと参照渡しの違いとその影響（Go言語の例） プログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\n1. 値渡し (Pass by Value) 引数として変数のコピーが関数に渡される。 関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。 副作用が発生しづらい。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x int) { x = 10 } func main() { a := 5 f(a) fmt.Println(a) // 5が出力される } structの場合も同様。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(person) fmt.Println(person) // {Original 20} が出力される } 2. 参照渡し (Pass by Reference) 引数として変数のアドレス（ポインタ）が関数に渡される。 関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。 副作用が発生する可能性が高まる。 例：\npackage main import \u0026#34;fmt\u0026#34; func f(x *int) { *x = 10 } func main() { a := 5 f(\u0026amp;a) fmt.Println(a) // 10が出力される } structの場合も同様に、フィールドの値を変更することができる。\npackage main import \u0026#34;fmt\u0026#34; type Person struct { Name string Age int } func f(p *Person) { p.Name = \u0026#34;Modified\u0026#34; p.Age = 100 } func main() { person := Person{Name: \u0026#34;Original\u0026#34;, Age: 20} f(\u0026amp;person) fmt.Println(person) // {Modified 100} が出力される } 速度の観点 データの大きさと速度:\n基本型（int, float, boolなど）や小さなデータ構造では、値渡しは効率的。 しかし、大規模なデータ構造や配列の場合、データのコピーが必要になるため、速度が落ちる可能性がある。この時、ポインタ渡しの方が効率的に動くことが多い。 関数の呼び出し頻度:\n関数が頻繁に呼ばれる場面では、値渡しでのデータのコピーが増える。その結果、パフォーマンスに影響が出るかもしれない。 ポインタ渡しを利用することで、このようなオーバーヘッドを減少させ、パフォーマンスを向上させることができる。 メモリのアクセスパターン:\nポインタを利用すると、メモリの異なる位置を参照することが増え、キャッシュミスが起きやすくなる。 一方、値渡しは連続したメモリ領域を使うため、キャッシュの効率が上がることがある。 データの変更とサイドエフェクト:\nポインタ渡しを利用する場合、関数内でのデータの変更が元のデータに影響する。このため、サイドエフェクトに注意が必要。 値渡しの場合、元のデータは変わらないため、このような心配は不要。 Reference Goのポインタ渡しは値渡しよりパフォーマンスが良いという誤解 \u0026hellip; トリビア: Goの構造体 int型のフィールド数4つまでなら値渡しと \u0026hellip; Go、ポインタにするか値にするかの方針を考えてみた - Qiita ","permalink":"http://localhost:1313/posts/programming/","summary":"\u003ch1 id=\"ソフトウェア概論\"\u003eソフトウェア概論\u003c/h1\u003e\n\u003cp\u003e自学用メモ。\u003c/p\u003e\n\u003ch2 id=\"関数の副作用\"\u003e関数の副作用\u003c/h2\u003e\n\u003cp\u003e関数や手続きがシステムの状態を変える現象を指す。また、システム外部とのやり取りも含む。\n具体的な例:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eグローバル変数の変更\u003c/strong\u003e：関数内でグローバル変数の値を変える。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eファイル操作\u003c/strong\u003e：ファイルの読み込みや保存。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eデータベース操作\u003c/strong\u003e：データの追加、更新、削除など。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e画面出力\u003c/strong\u003e：ユーザーインターフェースへの情報の表示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"純粋関数と副作用\"\u003e純粋関数と副作用\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e純粋関数\u003c/strong\u003e：与えられた入力に基づいて結果を返すだけの関数。外部の状態に影響を与えない。この性質のため、テストがしやすく、再利用性が高い。また、動作が予測しやすい。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e副作用の利点・欠点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e利点\u003c/strong\u003e：実際のアプリケーションでは、データの永続化やユーザーとのインタラクションなど、副作用が必要な操作が多い。これにより、具体的なタスクを実行する。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e欠点\u003c/strong\u003e：副作用を持つ関数は、他の部分との依存関係が強くなることがある。そのため、テストやデバッグが難しくなることがある。また、不具合の原因となることも。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"副作用のある関数のテスト方法\"\u003e副作用のある関数のテスト方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMock\u003c/strong\u003e：副作用を持つ部分（例：データベースや外部API）を模倣する。これにより、テスト中に実際の副作用を発生させずに関数の動作を検証できる。モックを使うと、特定の戻り値やエラーを模倣して、関数の反応をテストすることができる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStub\u003c/strong\u003e：関数やメソッドの実装を一時的に置き換える。これにより、テスト中の動作を制御できる。スタブを使うと、関数がどのように呼び出されたか、何回呼び出されたかなどの情報を取得できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSpy\u003c/strong\u003e：関数やメソッドの呼び出しを監視する。スパイを使うと、関数がどのように、何回、どの引数で呼び出されたかを検証できる。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e状態のリセット\u003c/strong\u003e：テストの前後でシステムの状態を初期化する。これにより、一つのテストが他のテストの結果に影響を与えることを防ぐ。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e統合テスト\u003c/strong\u003e：システムの複数の部分が連携して正しく動作するかを検証する。モックやスタブを使わず、実際の環境での動作を確認する。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"値渡しと参照渡しの違いとその影響go言語の例\"\u003e値渡しと参照渡しの違いとその影響（Go言語の例）\u003c/h2\u003e\n\u003cp\u003eプログラミングにおいて、関数やメソッドに変数を渡す方法として、値渡しと参照渡しがある。これらの方法は、関数内での変数の扱い方や副作用の有無に影響を与える。\u003c/p\u003e\n\u003ch3 id=\"1-値渡し-pass-by-value\"\u003e1. 値渡し (Pass by Value)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のコピーが関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数の値を変更しても、関数の外部にある元の変数の値は変わらない。\u003c/li\u003e\n\u003cli\u003e副作用が発生しづらい。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 5が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003estruct\u003c/code\u003eの場合も同様。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Modified\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePerson\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Original\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eperson\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// {Original 20} が出力される\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-参照渡し-pass-by-reference\"\u003e2. 参照渡し (Pass by Reference)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e引数として変数のアドレス（ポインタ）が関数に渡される。\u003c/li\u003e\n\u003cli\u003e関数内で引数を通じて変数の値を変更すると、関数の外部にある元の変数の値も変わる。\u003c/li\u003e\n\u003cli\u003e副作用が発生する可能性が高まる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e例：\u003c/strong\u003e\u003c/p\u003e","title":"ソフトウェア概論"},{"content":"2022年やったこと 2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\nMage Mageというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。 ちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。 この記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。 これから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\nSnowflake Snowflakeに関して記事をZennで発信したり、　terraform-provider-snowflakeというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\n気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\n他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\n上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。 社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。 今後の動きについては後述します。\n","permalink":"http://localhost:1313/posts/2023/","summary":"\u003ch1 id=\"2022年やったこと\"\u003e2022年やったこと\u003c/h1\u003e\n\u003cp\u003e2023年に注力することを整理するために、2022年の取り組みを振り返ってみる。\u003c/p\u003e\n\u003ch2 id=\"mage\"\u003eMage\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mage.ai/\"\u003eMage\u003c/a\u003eというデータパイプライン（ワークフロー）のツールに関する日本で最初の紹介記事を書いてみたりもした。\nちょうどワークフローツールの比較をしているときに、AirflowやPrefectなどとの比較をしているうちに存在を知って、Zennで紹介した。\nこの記事について、MageのCEOから感謝のメッセージを直接もらったりもしていて、印象に残っている。\nこれから伸びてほしいと思うし、自分も開発に加わっていこうという気持ちもある。\u003c/p\u003e\n\u003ch2 id=\"snowflake\"\u003eSnowflake\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.snowflake.com/?lang=ja\"\u003eSnowflake\u003c/a\u003eに関して記事をZennで発信したり、　\u003ca href=\"https://github.com/Snowflake-Labs/terraform-provider-snowflake\"\u003eterraform-provider-snowflake\u003c/a\u003eというOSSにもいくつものPRがマージされた。結果的に、上位コントリビュータの欄に出てくるようになった。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"zenn\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060143-aca492e2-46eb-4d71-bd01-16c481c5a8c9.png\" title=\"zenn\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"terraform\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212060400-85af2d54-29d6-4bbd-970c-b4fe6a7813d4.png\" title=\"terraform\"\u003e\u003c/p\u003e\n\u003cp\u003e気になるところを見つけてはPRを出していたので、年末ごろにはSnowflakeのエンジニアとマネージャーから、今後のproviderについて議論したいという連絡も受けた。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"pr\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212062196-1d884504-bc78-4260-87ba-8ad1fcf059a6.png\" title=\"pr\"\u003e\u003c/p\u003e\n\u003cp\u003e他にも、普段の業務で扱っているデータエンジニアリングの知識をもとに、Snowflakeを使ってデータ基盤を一式構築するための知見をZennの本として公開した。\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://user-images.githubusercontent.com/13862551/212061334-1274b65f-cb86-450c-acda-368b3a7077de.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上にあげたようなものをはじめ、2022年は特にSnowflakeでたくさん遊んだなぁ（貢献したなぁ）という気持ちで終了しました。\n社内でもチーム内外問わず質問のDMをいただけるようになったり、関連する話をたくさん相談されることになったので取り組んだことに対しては満足しています。\n今後の動きについては後述します。\u003c/p\u003e","title":"2023年何やるか整理する"},{"content":"Github ActionsでAWSと連携する Terraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\nOpenID connectを使う\nhttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services プロバイダー URL の場合: https://token.actions.githubusercontent.com を使います \u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\nreadonly role \u0026amp; policy readwrite role \u0026amp; policy をそれぞれ作成する\ngithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\n","permalink":"http://localhost:1313/posts/aws/","summary":"\u003ch1 id=\"github-actionsでawsと連携する\"\u003eGithub ActionsでAWSと連携する\u003c/h1\u003e\n\u003cp\u003eTerraformなどを使ってリソース管理をしたい場合に、github actionsと連携する方法。\u003c/p\u003e\n\u003cp\u003eOpenID connectを使う\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\"\u003ehttps://docs.github.com/ja/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eプロバイダー URL の場合: \u003ca href=\"https://token.actions.githubusercontent.com\"\u003ehttps://token.actions.githubusercontent.com\u003c/a\u003e を使います\n\u0026ldquo;Audience\u0026rdquo; の場合: 公式のアクションを使っている場合は、sts.amazonaws.com を使います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003ereadonly role \u0026amp; policy\u003c/li\u003e\n\u003cli\u003ereadwrite role \u0026amp; policy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eをそれぞれ作成する\u003c/p\u003e\n\u003cp\u003egithubのcredentialにアカウント番号など設定したり、aws-configureが動くように設定する必要がある。\u003c/p\u003e","title":"github actions"},{"content":"ffmpegを使って動画を軽量化する。\nffmpeg ffmpegは動画や音声を加工するためのツール。\nMacの標準の画面収録で作成される.movという形式の動画ファイルは容量が大きいので.mp4に変換することでクラウドにアップロードしたりしている。\n特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\n基本的にこれで良い brew install ffmpeg ffmpeg -i original.mov transformed.mp4 original.movが変換前の動画。Macで画面収録した時に生成される。 transformed.mp4が変換後の動画。結構圧縮できることがある。 ","permalink":"http://localhost:1313/posts/ffmpeg/","summary":"\u003cp\u003effmpegを使って動画を軽量化する。\u003c/p\u003e\n\u003ch1 id=\"ffmpeg\"\u003effmpeg\u003c/h1\u003e\n\u003cp\u003effmpegは動画や音声を加工するためのツール。\u003c/p\u003e\n\u003cp\u003eMacの標準の画面収録で作成される\u003ccode\u003e.mov\u003c/code\u003eという形式の動画ファイルは容量が大きいので\u003ccode\u003e.mp4\u003c/code\u003eに変換することでクラウドにアップロードしたりしている。\u003c/p\u003e\n\u003cp\u003e特に学会発表とかで動画を用意しておかないといけない時にアップロード上限などに収まらない時に使っていた。\u003c/p\u003e\n\u003ch2 id=\"基本的にこれで良い\"\u003e基本的にこれで良い\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ffmpeg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effmpeg -i original.mov transformed.mp4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoriginal.movが変換前の動画。Macで画面収録した時に生成される。\u003c/li\u003e\n\u003cli\u003etransformed.mp4が変換後の動画。結構圧縮できることがある。\u003c/li\u003e\n\u003c/ul\u003e","title":"ffmpeg: 動画の圧縮・変換"},{"content":"Pytest Pytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\nPytest Pytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。 decoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。 decoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\n代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\n関係するツールなど SQLite Pytest まず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\nimport pytest @pytest.fixture def fixture_prepare_records(): with sqlite.session_manager(use_test=True) as session: # (1) データベースへのinsert # (2) テスト関数の実行 yield with sqlite.session_manager(use_test=True) as session: # (3) データベースからのdelete def test_slot_dialog_repo(fixture_prepare_records): with sqlite.session_manager(use_test=True) as session: # (4) selectなどを使ったテスト 必要なデータのinsert test関数の実行 使用したデータのdelete fixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント） context.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\nimport contextlib @contextlib.contextmanager def session_manager(use_test: bool = False): if use_test: # (1)テスト用のパスをセットする Params.set_test_env() # (2)SQLiteとの接続用のClient sqlc = SQLiteClient() session = sqlc.create_session() try: yield session session.commit() except Exception as e: logger.error(e) session.rollback() raise e finally: session.close() if use_test: # (3)最後にprdに戻す Params.set_prd_env() Paramsにはclassmethodとしてデータベースのパスを変更が実装されている。 yield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。 context.managerのwithの範囲が終了した時に必ず実行されるようになっている。 SQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\nimport sqlalchemy from sqlalchemy.orm import sessionmaker class SQLiteClient: def __init__(self): resource = Params.data_resource self.resource = f\u0026#34;sqlite:///{resource}\u0026#34; self.engine = sqlalchemy.create_engine(self.resource, echo=False) def create_tables(self): # データベースにテーブルを作成する Base.metadata.create_all(bind=self.engine) def create_session(self): # データベースとの新しいsessionを作成する create_session = sessionmaker(bind=self.engine) return create_session() 最初は@use_testdbというようにdecoratorとしてデータベースの切り替えを実装しようとしていたが、pytestとぶつかってしまうということがわかったのでcontext.managerを使うことにした。 例えば@pytest.mark.parametrizeなどのpytestが提供する機能を使えるようになったので、コードがすっきりした。\nデータベースのユニットテストでは、データベースと正しくデータがやりとりできるかをチェックしているが、それよりも上の層では、pytestの機能のmockerなども使用して、データベースにはアクセスしないでロジック部分だけをテストできるようにした。\n","permalink":"http://localhost:1313/posts/python-pytest/","summary":"\u003ch1 id=\"pytest\"\u003ePytest\u003c/h1\u003e\n\u003cp\u003ePytestを使用する場合に、テスト用/本番用のデータベースを分離する際に行なった方法などをメモしておく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePytestを使っていて分かったのは、Pytest自体がテスト関数に対して暗黙的にdecoratorなどを使っているため、自分で実装したdecoratorがぶつかってしまうことがあった。\ndecoratorをPytestと一緒に使うことはあまり好ましいとは思えなかった。\ndecoratorに渡さないといけない引数などが把握しにくかったり、勝手にPytestから引数を意図せず渡してしまうことになる。\u003c/p\u003e\n\u003cp\u003e代わりにcontext.managerを活用して、テスト時にテスト用のデータベースに切り替えるという実装をした。\u003c/p\u003e\n\u003ch2 id=\"関係するツールなど\"\u003e関係するツールなど\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.sqlite.org/index.html\"\u003eSQLite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/index.html\"\u003ePytest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eまず、データベースのテストのためのfixtureを作成する。擬似コードは以下のよう。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003epytest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1) データベースへのinsert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2) テスト関数の実行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3) データベースからのdelete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_slot_dialog_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efixture_prepare_records\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esqlite\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (4) selectなどを使ったテスト\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e必要なデータのinsert\u003c/li\u003e\n\u003cli\u003etest関数の実行\u003c/li\u003e\n\u003cli\u003e使用したデータのdelete\u003c/li\u003e\n\u003cli\u003efixtureで用意したデータを使ってselectなどのテスト（引数としてfixture_prepare_recordsを渡しているところがポイント）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003econtext.managerで実装したsqliteの向き先の変更は以下のよう。デフォルトでは本番DBのパスを向けるようにしている。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003econtextlib\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nd\"\u003e@contextlib.contextmanager\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003esession_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ebool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (1)テスト用のパスをセットする\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_test_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# (2)SQLiteとの接続用のClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLiteClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esqlc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_session\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecommit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollback\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003euse_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# (3)最後にprdに戻す\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset_prd_env\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eParamsにはclassmethodとしてデータベースのパスを変更が実装されている。\u003c/li\u003e\n\u003cli\u003eyield sessionの部分でsessionを返すことができるので、終わった時にはsessionのclose処理などを正しく実行できるようにしている。\u003c/li\u003e\n\u003cli\u003econtext.managerのwithの範囲が終了した時に必ず実行されるようになっている。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSQLiteClientの実装は次のようになっている。もう少しうまく実装できると思っているので、このあたりの実装はもう少し改善したいと思っている。\u003c/p\u003e","title":"Pytest context manager"},{"content":"Makefileの基本設定について\nMakefile ディレクトリにMakefileとしてファイルを作成する。\n# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う VARIABLE = hoge TARGET = target .PHONY: command-name command-name: ## comment of this command # ここにコマンドを書く cd dir_name .PHONY: help help: ## Display this help screen @grep -E \u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39; $(MAKEFILE_LIST) | awk \u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39; Usage make helpでコマンド一覧を表示することができる。 make command-nameという方法で実行することができる。 makeのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だとmake command-nameを実行したときと同じである。 ","permalink":"http://localhost:1313/posts/makefile/","summary":"\u003cp\u003eMakefileの基本設定について\u003c/p\u003e\n\u003ch1 id=\"makefile\"\u003eMakefile\u003c/h1\u003e\n\u003cp\u003eディレクトリに\u003ccode\u003eMakefile\u003c/code\u003eとしてファイルを作成する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 上部に共通で使用する変数を書く。 cd $(TARGET)などのように使う\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVARIABLE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e hoge\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: command-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecommand-name:  \u003cspan class=\"c1\"\u003e## comment of this command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e# ここにコマンドを書く\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e dir_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.PHONY: \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehelp: \u003cspan class=\"c1\"\u003e## Display this help screen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t@grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^[a-zA-Z_-]+:.*?## .*$$\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eMAKEFILE_LIST\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {FS = \u0026#34;:.*?## \u0026#34;}; {printf \u0026#34;\\033[36m%-20s\\033[0m %s\\n\u0026#34;, $$1, $$2}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"usage\"\u003eUsage\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emake help\u003c/code\u003eでコマンド一覧を表示することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake command-name\u003c/code\u003eという方法で実行することができる。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emake\u003c/code\u003eのみを入力した場合は、一番上のコマンドが実行される。つまり、上の例だと\u003ccode\u003emake command-name\u003c/code\u003eを実行したときと同じである。\u003c/li\u003e\n\u003c/ul\u003e","title":"Makefile setup"},{"content":"Github PagesとHugoでProfileページを作って公開する。\nはじめ方 $ brew install hugo $ hugo new site $(siteName) テンプレートとしてPaperModを使用する。\n$ cd $(siteName) $ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ─╯ $ git submodule update --init --recursive config.ymlを更新する。\n公開方法 Repository home -\u0026gt; Settings -\u0026gt; Pages からデプロイ方法にGithub Actionsを指定する。 config.ymlのbaseURLの下あたりに、publishDir: \u0026quot;public\u0026quot;を追加する。\n更新方法 hugo server -Dでローカルでサーバが起動する。\nhugo new post/${pageTitle}.mdで新しいページを作成する。 そして、マークダウンファイルを更新する。 公開したい場合はdraft: falseに変更する。\nGoogle search console sitemap.xmlをサイトマップに登録する。 ","permalink":"http://localhost:1313/posts/github-pages-hugo/","summary":"\u003cp\u003eGithub PagesとHugoでProfileページを作って公開する。\u003c/p\u003e\n\u003ch2 id=\"はじめ方\"\u003eはじめ方\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ brew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ hugo new site \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eテンプレートとして\u003ccode\u003ePaperMod\u003c/code\u003eを使用する。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003esiteName\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                                                                                  ─╯\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig.ymlを更新する。\u003c/p\u003e\n\u003ch2 id=\"公開方法\"\u003e公開方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eRepository home -\u0026gt; Settings -\u0026gt; Pages\u003c/code\u003e からデプロイ方法にGithub Actionsを指定する。\n\u003ccode\u003econfig.yml\u003c/code\u003eのbaseURLの下あたりに、\u003ccode\u003epublishDir: \u0026quot;public\u0026quot;\u003c/code\u003eを追加する。\u003c/p\u003e\n\u003ch2 id=\"更新方法\"\u003e更新方法\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehugo server -D\u003c/code\u003eでローカルでサーバが起動する。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo new post/${pageTitle}.md\u003c/code\u003eで新しいページを作成する。\nそして、マークダウンファイルを更新する。\n公開したい場合は\u003ccode\u003edraft: false\u003c/code\u003eに変更する。\u003c/p\u003e\n\u003ch2 id=\"google-search-console\"\u003eGoogle search console\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esitemap.xmlをサイトマップに登録する。\u003c/li\u003e\n\u003c/ul\u003e","title":"Github Pages + Hugo"},{"content":"About Me Masatoshi Nagahama (長濱 直智), Software Engineer at Sansan, Inc. ex-Tech Lead of Software/Data Engineer \u0026amp; Cloud Architect at CyberAgent, Inc.\n数理最適化、機械学習（深層学習）、信号処理分野で修士号を取得。\nProfessional Experience Software Engineer Data Engineer Cloud Architect Research Scientist Work Experience 2024.09 - Current: Sansan, Inc., Software Engineer. 2022.04 - 2024.08: CyberAgent, Inc., Software Engineer. DSPの開発に従事。サーバーのパフォーマンスチューニング、データ基盤構築、クラウド最適化などを行う。クラウドサービス、サーバレスアーキテクチャ、クラウドのコスト最適化、キャッシュシステムなどに詳しい。新卒向けにデータエンジニアリング、SQLの講義を担当した。\nI am deeply involved in the development of DSPs (Demand Side Platforms), comprehensive tools meticulously designed to streamline the process of advertisement delivery and ensure precise audience targeting, enabling our clients to achieve peak advertising performance. My work encompasses the construction of data infrastructures leveraging Snowflake, server implementations using the Go language, and the development of robust infrastructures powered by AWS.\nTo guarantee rapid server response and efficiency, I employ advanced techniques such as in-memory caching and make use of tools like Memcached. Furthermore, drawing on the inherent concurrency features of Go, I ensure our servers are not only fast but also optimized for peak performance.\nAdditionally, I pride myself on my expertise in optimizing and speeding up database systems, particularly with MySQL and DynamoDB. With a holistic approach to system development, I ensure that every component, from data storage to server execution, is honed for excellence.\n2024.02 - 2025.07: ALGO ARTIS, Inc., Software Engineer (contract). 2020.10 - 2024.01: SUPWAT, Inc., Software Engineer / Data Scientist (contract). 2021.09 - 2023.03: Megagon Labs., Software Engineer (contract). 2020.08 - 2021.04: Forcia, Inc., Data Scientist (part-time): dynamic pricing algorithm and systems. ダイナミックプライシングの予測モデルの開発に従事。Python (Machine Learning)、TypeScipt, PostgreSQL etc\u0026hellip;\n2019.10 - 2020.07: ****, Data Scientist (part-time). 自然言語処理を用いた推薦システムの構築に従事。\nI was deeply involved in tasks pivotal to natural language processing (NLP). My responsibilities included web scraping for data collection tailored for language learning, utilizing MeCab for morphological analysis, and employing tf-idf for word ranking. These tasks were all instrumental in building a recommendation system that leveraged the power of NLP. My role not only allowed me to deepen my expertise in NLP but also to understand the practical application of these techniques in the construction of recommendation engines.\nEngineering Skills Languages \u0026amp; Frameworks Go — メインで使用。並行処理、サーバー、CLI など Python — FastAPI, Flask, PyTorch, gensim, Scrapy, Poetry など TypeScript / JavaScript — React, Next, Vue, Nuxt, Chakra UI, MUI, Vuetify など Architecture \u0026amp; Design Domain-Driven Design (DDD) Distributed Systems / Distributed Architecture Data \u0026amp; Storage RDB / Data Warehouse: MySQL, PostgreSQL, Snowflake, Cloud Spanner NoSQL / Cache: DynamoDB, Redis, Memcached Cloud \u0026amp; Infrastructure AWS — 4 certified ⭐️ Google Cloud — Cloud Spanner, BigQuery, Cloud Run, Cloud Functions など Snowflake, Datadog Terraform (AWS, Snowflake), Docker, GitHub Actions Performance \u0026amp; Tuning サーバー・DB・SQL のチューニング、インメモリキャッシュ設計 Tools \u0026amp; Others GitHub, RabbitMQ, zsh, bash — Mac / Linux Certifications AWS: 4 certified CG Engineer Expert (2018) TOEIC 835 (2018) Research Interests Graph Signal Processing: Signal recovery, denoising, and restoration Mathematical Optimization: convex optimization, optimization algorithm Image Processing: Image coding and image compression Machine Learning (Deep Learning) 📗 Publications Journal Paper M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal restoration using nested deep algorithm unrolling,\u0026rdquo; IEEE Transactions on Signal Processing, vol. 70, pp. 3296-3311, 2022. [Project Page] [IEEE Xplore] [pdf] Conference Paper M. Nagahama and Y. Tanaka, \u0026ldquo;Multimodal graph signal denoising via twofold graph smoothness regularization with deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2022, Singapore, May 2022. [IEEE Xplore] M. Nagahama, K. Yamada, Y. Tanaka, S. H. Chan, and Y. C. Eldar, \u0026ldquo;Graph signal denoising using nested-structured deep algorithm unrolling,\u0026rdquo; IEEE International Conference on Acoustics, Speech, and Signal Processing, ICASSP 2021, Virtual Conference, Jun. 2021. [IEEE Xplore] Awards / Grants 日本学生支援機構 大学院第一種奨学金 特に優れた業績による返還免除 (2020.4 - 2022.3) 📗 Books SnowflakeとTerraformで作るデータ基盤入門 Building Modern Data Platforms: A Guide to Snowflake and Terraform 🗣️ Talks 2023.12 ディビジョン内勉強会 「パフォーマンスチューニング・クラウドコスト最適化」 60min DSPのパフォーマンスチューニングやクラウドのコストを下げるためのポイントを解説、キャッシュシステムなどの解説 2023.12 チーム内勉強会 「Goを書く技術」 60min — Go言語上級向け 2023.5 社内新卒研修 「データベース・SQL研修」 90min 2023.5 社内新卒研修 「データエンジニアリング研修」 90min — データ基盤の作り方などを新卒向けに解説 Blog / Posts はてなブログ: 最近の記事（下に一覧） Zenn: 投稿一覧 はてなブログ 最近記事:\nAmazon S3ストレージ最適化方法 [2024.10.23] 通信方式 vol.3 (HTTP1.1) [2024.09.29] 通信方式 vol.2 (Socket通信について) [2024.09.29] 通信方式 vol.1 (WebSocket) [2024.09.25] チームトポロジー、SRE、Platform Engineering [2024.07.14] zodについて [2024.07.07] golangci-lintとRenovate [2024.06.19] データストア #2 Redis [2024.06.08] データストア #1 インメモリキャッシュ序章 [2024.06.08] データベース #3 データ格納 [2024.06.02] データベース #2 行/列志向とか圧縮とかの周辺 [2024.06.01] データベース #1 基礎編 [2024.05.29] ソフトウェア原理原則 [2024.05.28] OSS / Software terraform-provider-snowflake — コントリビューション stackerrors SNS / Links Google Scholar IEEE Profile ORCID Research Gate LinkedIn Zenn Blog ","permalink":"http://localhost:1313/profile/","summary":"profile","title":"Profile"}]